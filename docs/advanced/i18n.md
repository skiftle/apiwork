---
order: 4
---

# i18n

Apiwork uses Rails' I18n for translatable strings. Error messages, validation feedback, and other user-facing text can be customized per locale.

Translations are resolved at runtime. The same API definition produces localized responses based on `I18n.locale`.

## Error Codes

Error codes from `respond_with_error` resolve messages through i18n.

### Lookup Order

1. **API-specific** — `apiwork.apis.<path>.error_codes.<code>.description`
2. **Global** — `apiwork.error_codes.<code>.description`
3. **Fallback** — Code titleized (`not_found` → "Not Found")

### Global Translations

Override built-in messages for all APIs:

```yaml
# config/locales/en.yml
en:
  apiwork:
    error_codes:
      not_found:
        description: "The requested resource could not be found"
      forbidden:
        description: "You don't have permission to access this resource"
```

### API-specific Translations

Different APIs can have different messages. For an API mounted at `/api/v1`:

```yaml
# config/locales/en.yml
en:
  apiwork:
    apis:
      api/v1:
        error_codes:
          not_found:
            description: "Item not found"
```

The path matches your API's mount path without the leading slash.

### Multiple Languages

```yaml
# config/locales/sv.yml
sv:
  apiwork:
    error_codes:
      bad_request:
        description: "Felaktig förfrågan"
      unauthorized:
        description: "Autentisering krävs"
      forbidden:
        description: "Åtkomst nekad"
      not_found:
        description: "Resursen hittades inte"
      conflict:
        description: "Konflikt med nuvarande tillstånd"
      unprocessable_entity:
        description: "Valideringsfel"
      internal_server_error:
        description: "Ett oväntat fel inträffade"
```

### Interpolation

Dynamic values can be inserted into messages:

```yaml
en:
  apiwork:
    error_codes:
      rate_limited:
        description: "Too many requests. Try again in %{seconds} seconds."
```

```ruby
respond_with_error :rate_limited, i18n: { seconds: 60 }
```

Response:

```json
{
  "issues": [
    {
      "code": "rate_limited",
      "detail": "Too many requests. Try again in 60 seconds.",
      "path": [],
      "pointer": "",
      "meta": {}
    }
  ]
}
```

### Custom Error Codes

Register custom codes and add translations:

```ruby
# config/initializers/error_codes.rb
Apiwork::ErrorCode.register :insufficient_funds, status: 402
```

```yaml
# config/locales/en.yml
en:
  apiwork:
    error_codes:
      insufficient_funds:
        description: "Insufficient funds for this transaction"

# config/locales/sv.yml
sv:
  apiwork:
    error_codes:
      insufficient_funds:
        description: "Otillräckligt saldo för denna transaktion"
```

## Action Metadata

Action documentation — summaries, descriptions — can be translated too. This is useful for APIs that serve multiple locales or generate localized OpenAPI specs.

### Where to Define

You have two options:

**In the Contract** (inline):
```ruby
action :index do
  summary "List all invoices"
  description "Returns invoices for the authenticated account"
end
```

**In locale files** (translatable):
```yaml
en:
  apiwork:
    apis:
      api/v1:
        contracts:
          invoice:
            actions:
              index:
                summary: "List all invoices"
                description: "Returns invoices for the authenticated account"
```

### Lookup Order

1. **Inline value** — If the Contract defines `summary` or `description`, that wins
2. **Locale file** — `apiwork.apis.<path>.contracts.<name>.actions.<action>.<field>`
3. **nil** — No text

Inline values are constants. Locale values change with `I18n.locale`.

### Locale File Structure

```yaml
en:
  apiwork:
    apis:
      api/v1:                    # API mount path (without leading /)
        contracts:
          invoice:               # Contract name (without _contract suffix)
            actions:
              index:             # Action name
                summary: "..."
                description: "..."
              create:
                summary: "..."
```

### Multiple Languages

```yaml
# config/locales/api.en.yml
en:
  apiwork:
    apis:
      api/v1:
        contracts:
          invoice:
            actions:
              index:
                summary: "List invoices"
                description: "Returns all invoices for this account"

# config/locales/api.sv.yml
sv:
  apiwork:
    apis:
      api/v1:
        contracts:
          invoice:
            actions:
              index:
                summary: "Lista fakturor"
                description: "Returnerar alla fakturor för detta konto"
```

### When to Use Each Approach

| Approach | Use when |
|----------|----------|
| Inline in Contract | Single language, simple API, developer-facing docs |
| Locale files | Multi-language, user-facing docs, OpenAPI for different markets |

You can mix both — use inline for some actions, locale files for others. Inline always wins when present.

## Type Descriptions

Type descriptions can be translated via i18n. This is useful when adapters generate types (like filters and payloads) that you want to document in multiple languages.

### Lookup Order

1. **Inline** — `description:` option on the type definition
2. **Schema class** — If the type has a schema class with `.description`
3. **Locale file** — `apiwork.apis.<path>.types.<type_name>.description`
4. **nil** — No description

### Locale File Structure

```yaml
en:
  apiwork:
    apis:
      api/v1:
        types:
          invoice_filter:
            description: "Search and filter invoices"
          invoice_create_payload:
            description: "Data for creating a new invoice"
```

### Multiple Languages

```yaml
# config/locales/api.en.yml
en:
  apiwork:
    apis:
      api/v1:
        types:
          invoice_filter:
            description: "Filter invoices"

# config/locales/api.sv.yml
sv:
  apiwork:
    apis:
      api/v1:
        types:
          invoice_filter:
            description: "Filtrera fakturor"
```

## Schema Attribute Descriptions

Attributes defined in schemas can have their descriptions translated via i18n. This is useful when the same attribute appears in multiple generated types (filters, payloads, responses).

### Lookup Order

1. **Inline** — `description:` option on the attribute definition
2. **Locale file** — `apiwork.apis.<path>.schemas.<schema_name>.attributes.<attr_name>.description`
3. **nil** — No description

### Locale File Structure

```yaml
en:
  apiwork:
    apis:
      api/v1:
        schemas:
          invoice:
            attributes:
              number:
                description: "Unique invoice identifier"
              status:
                description: "Current invoice status"
              amount:
                description: "Total invoice amount"
```

### Multiple Languages

```yaml
# config/locales/api.en.yml
en:
  apiwork:
    apis:
      api/v1:
        schemas:
          invoice:
            attributes:
              number:
                description: "Invoice number"

# config/locales/api.sv.yml
sv:
  apiwork:
    apis:
      api/v1:
        schemas:
          invoice:
            attributes:
              number:
                description: "Fakturanummer"
```

## Built-in Defaults

Apiwork provides English translations for all 20 built-in error codes. Type and attribute descriptions have no built-in defaults — add them via `description:` option, locale files, or [Type Merging](../core/type-system/type-merging).
